## 离线实验介绍
### 实验设置
考虑这样一个系统，包含以下模块：
- 点击率预估模块。
    &emsp;&emsp;此模块根据输入的用户流量特征等进行用户流量质量的评估，估计此用户点击此广告的具体概率，输出给后续模块方便其进行出价参考。

    &emsp;&emsp;实验暂时采用 logistic regression：$ctr = sigmoid(w * x)$，负责所有流量（包括不同广告主）的CTR预估，所有广告主共用一个CTR模型

- 出价策略模块。
    &emsp;&emsp;此模块接受上游模块的输出预估点击率，根据某种出价策略对这条用户流量进行针对性的出价。

    &emsp;&emsp;实验暂时采用 Truthful Bidding：$bid\_price = ctr * camp\_v$，其中 $camp\_v$ 为训练数据集的 $ecpc = cost\_sum / clk\_sum$。不同广告主的 $camp\_v$ 不同，使用不同的 bidding 模型。Truthful Bidding 模型不用训练

采用的数据格式：
    &emsp;&emsp;使用两个广告主 A 和 B 的所有 yzx 格式数据，分别表示 用户点击与否的真实标签、winning_price、特征信息

### 实验流程
&emsp;&emsp;考虑在二价出价场景中，将所有数据等分成 n 份 （n = 5），每份数据均包含两个广告主，进行以下不同流程。
- V1：使用第一份训练，在第二份上模拟，模拟过程中竞胜的数据加入训练更新 CTR 模型，再在第三份上模拟，竞胜的数据加入训练，一直持续到最后一份
- V2: 使用前 n-1 份所有数据（全样本空间）训练，在最后一份上模拟

### 探究问题/实验结果
&emsp;&emsp;模拟过程中若竞败，无法进行曝光，从而无法得到真实的用户点击标签，难以拿来进行 CTR 模型梯度更新训练，即 CTR 模型只能使用竞胜的数据样本进行参数更新。假设初次训练后的模型由于不同广告主之间数据相互干扰，导致能够对某广告主进行准确且合理的价值预估及出价，但无法适配其他广告主，那么在对新到的数据样本进行模拟出价过程中，此广告主相比其他广告主能够获得更多的竞胜数据样本，这更进一步地导致后序再训练更新参数时会更准确的适配此广告主而忽视其余广告主。这样的问题可以被概括为模型对某个广告主“越估越准”。

&emsp;&emsp;具体实验结果表现为：V2 流程结果中两个广告主收益占比相差不大，表示两个广告主同等重要，但 V1 流程中，某个广告主获得的竞胜数据量占比较大，收益占比也较大，因此能得到较好的训练，使得后续的竞胜数据量占比随之增大，收益占比也随之增大，进而持续下去。

## 后续工作路线
1. 尝试使用腾讯真实业务数据进行上述实验流程，观察是否有“越估越准”的实验现象。
2. 更改出价策略，加入探索要素，让本应表现好但实际表现差的广告主得到适当曝光，从而影响 CTR 模型的训练，提高此广告主的后续表现，解决对另一个广告主“越估越准”的问题。


